Array Bounds check not working when index is an expression